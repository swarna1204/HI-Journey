<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>VR Debug Test â€“ Hand Controller Clicks</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
</head>

<body>
    <a-scene background="color: #ECECEC" xr-mode-ui="enabled: true" embedded>

        <!-- Camera + Controllers -->
        <a-entity id="rig" position="0 1.6 0">
            <a-camera>
                <a-cursor fuse="false" material="color: black; shader: flat" raycaster="objects: .clickable"
                    position="0 0 -1" geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"></a-cursor>
            </a-camera>

            <!-- Left hand -->
            <a-entity id="leftHand" meta-touch-controls="hand: left" raycaster="objects: .clickable; showLine: true"
                line="color: #00BCD4" debug-vr-input debug-raycast>
            </a-entity>

            <!-- Right hand -->
            <a-entity id="rightHand" meta-touch-controls="hand: right" raycaster="objects: .clickable; showLine: true"
                line="color: #FF4081" debug-vr-input debug-raycast>
            </a-entity>
        </a-entity>

        <!-- Light -->
        <a-entity light="type: directional; intensity: 1" position="2 4 -2"></a-entity>

        <!-- Test Box -->
        <a-box class="clickable" position="0 1.5 -3" color="#4CC3D9" depth="1" height="1" width="1">
        </a-box>

    </a-scene>

    <script>
        // Debug controller trigger & button input
        AFRAME.registerComponent('debug-vr-input', {
            init: function () {
                const el = this.el;
                el.addEventListener('triggerdown', evt => console.log('[VR] triggerdown', el.id, evt));
                el.addEventListener('abuttondown', evt => console.log('[VR] abuttondown', el.id, evt));
                el.addEventListener('bbuttondown', evt => console.log('[VR] bbuttondown', el.id, evt));
                el.addEventListener('gripdown', evt => console.log('[VR] gripdown', el.id, evt));
            }
        });

        // Debug raycast intersection
        AFRAME.registerComponent('debug-raycast', {
            init: function () {
                const el = this.el;
                el.addEventListener('raycaster-intersection', evt => {
                    console.log('[Raycaster] intersected objects from', el.id, evt.detail.els.map(e => e.tagName + ' ' + e.getAttribute('class')));
                });
                el.addEventListener('raycaster-intersection-cleared', evt => {
                    console.log('[Raycaster] cleared from', el.id);
                });
            }
        });
    </script>
</body>

</html>