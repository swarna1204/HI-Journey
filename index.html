<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>VR Controller Final Test</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
</head>

<body>
    <a-scene background="color: #111" xr-mode-ui="enabled: true">

        <!-- Ground -->
        <a-plane position="0 0 -4" rotation="-90 0 0" width="10" height="10" color="#444"></a-plane>

        <!-- Red Box to interact with -->
        <a-box id="target-box" class="clickable" position="0 1.5 -3" color="red"></a-box>

        <!-- Lighting -->
        <a-entity light="type: directional; intensity: 1" position="1 2 1"></a-entity>
        <a-entity light="type: ambient; intensity: 0.6"></a-entity>

        <!-- Camera Rig -->
        <a-entity id="rig" position="0 1.6 0">
            <a-camera>
                <!-- For desktop support -->
                <a-cursor fuse="false" raycaster="objects: .clickable" material="color: yellow"
                    geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02" position="0 0 -1">
                </a-cursor>
            </a-camera>

            <!-- Right Controller -->
            <a-entity id="rightHand" oculus-touch-controls="hand: right" raycaster="objects: .clickable; showLine: true"
                line="color: #FF4081" vr-button-click-logger>
            </a-entity>

            <!-- Left Controller -->
            <a-entity id="leftHand" oculus-touch-controls="hand: left" raycaster="objects: .clickable; showLine: true"
                line="color: #00BCD4" vr-button-click-logger>
            </a-entity>
        </a-entity>
    </a-scene>

    <script>
        AFRAME.registerComponent('vr-button-click-logger', {
            init: function () {
                const el = this.el;

                el.addEventListener('raycaster-intersection', function (e) {
                    console.log('üéØ Raycaster seeing:', e.detail.els.map(el => el.id || el.tagName));
                });

                el.addEventListener('raycaster-intersection-cleared', function () {
                    console.log('‚ö™ Raycaster cleared from:', el.id);
                });

                el.addEventListener('buttondown', function () {
                    const intersectedEl = el.components.raycaster.intersectedEl;
                    if (intersectedEl) {
                        console.log('‚úÖ HIT:', intersectedEl.id || intersectedEl.tagName || intersectedEl.className);
                    } else {
                        console.log('‚ùå Button pressed, but no intersectedEl');
                    }
                });
            }
        });
    </script>
</body>

</html>